# -*- coding: utf-8 -*-
"""Copy of loan-prediction-project-detailed.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1gzaANcWJzuP_QQpdFEeZ9aCkbkwdqAWf

# Loan Prediction
## Binary Classification using Logistic Regression

### Importing Libraries
"""

# Commented out IPython magic to ensure Python compatibility.
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
# %matplotlib inline
import seaborn as sns
import warnings
warnings.filterwarnings('ignore')

"""### Importing & Loading the dataset"""

df = pd.read_csv('train.csv')
df.head()

"""### Dataset Info:"""

df.info()

"""### Dataset Shape:"""

df.shape

"""## Data Cleaning

### Checking the Missing Values
"""

df.isnull().sum()

"""#### First we will fill the Missing Values in "LoanAmount" & "Credit_History" by the 'Mean' & 'Median' of the respective variables."""

df['LoanAmount'] = df['LoanAmount'].fillna(df['LoanAmount'].mean())

df['Credit_History'] = df['Credit_History'].fillna(df['Credit_History'].median())

"""### Let's confirm if there are any missing values in 'LoanAmount' & 'Credit_History'"""

df.isnull().sum()

"""### Now, Let's drop all the missing values remaining."""

df.dropna(inplace=True)

"""### Let's check the Missing values for the final time!"""

df.isnull().sum()

"""Here, we have dropped all the missing values to avoid disturbances in the model. The Loan Prediction requires all the details to work efficiently and thus the missing values are dropped.

### Now, Let's check the final Dataset Shape
"""

df.shape

"""### Exploratory Data Analyis

#### Comparison between Parameters in getting the Loan:
"""

plt.figure(figsize = (100, 50))
sns.set(font_scale = 5)
plt.subplot(331)
sns.countplot(x='Gender',hue='Approval_Status',data=df)

plt.subplot(332)
sns.countplot(x='Married',hue='Approval_Status',data=df)

plt.subplot(333)
sns.countplot(x='Education',hue='Approval_Status',data=df)

plt.subplot(334)
sns.countplot(x='Self_Employed',hue='Approval_Status',data=df)

plt.subplot(335)
sns.countplot(x='Property_Area',hue='Approval_Status',data=df)



"""### Let's replace the Variable values to Numerical form & display the Value Counts

The data in Numerical form avoids disturbances in building the model.
"""

df['Approval_Status'].replace('Y',1,inplace=True)
df['Approval_Status'].replace('N',0,inplace=True)

df['Approval_Status'].value_counts()

df.Gender=df.Gender.map({'Male':1,'Female':0})
df['Gender'].value_counts()

df.Married=df.Married.map({'Yes':1,'No':0})
df['Married'].value_counts()

df.Dependents=df.Dependents.map({'0':0,'1':1,'2':2,'3+':3})
df['Dependents'].value_counts()

df.Education=df.Education.map({'Graduate':1,'Not Graduate':0})
df['Education'].value_counts()

df.Self_Employed=df.Self_Employed.map({'Yes':1,'No':0})
df['Self_Employed'].value_counts()

df.Property_Area=df.Property_Area.map({'Urban':2,'Rural':0,'Semiurban':1})
df['Property_Area'].value_counts()

df['LoanAmount'].value_counts()

df['Loan_Amount_Term'].value_counts()

df['Credit_History'].value_counts()



"""From the above figure, we can see that **Credit_History** (Independent Variable) has the maximum correlation with **Loan_Status** (Dependent Variable). Which denotes that the Loan_Status is heavily dependent on the Credit_History.

### Final DataFrame
"""

df.head()

"""### Importing Packages for Classification algorithms"""

from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn import metrics

"""### Splitting the data into Train and Test set"""

X = df.iloc[1:542,1:12].values
y = df.iloc[1:542,12].values

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3,random_state=0)

"""### Logistic Regression (LR)

Logistic regression is a supervised learning classification algorithm used to predict the probability of a target variable.

Mathematically, a logistic regression model predicts P(Y=1) as a function of X. It is one of the simplest ML algorithms that can be used for various classification problems such as spam detection, Diabetes prediction, cancer detection etc.

#### Sigmoid Function

![logistic%20regression.png](attachment:logistic%20regression.png)
"""

model = LogisticRegression()
model.fit(X_train,y_train)

lr_prediction = model.predict(X_test)
print('Logistic Regression accuracy = ', metrics.accuracy_score(lr_prediction,y_test))

print("y_predicted",lr_prediction)
print("y_test",y_test)

"""**CONCLUSION:**

1. The Loan Status is heavily dependent on the Credit History for Predictions.
2. The Logistic Regression algorithm gives us the maximum Accuracy (79% approx) compared to the other 3 Machine Learning Classification Algorithms.
"""

